<!DOCTYPE html>
<html lang="fr">

  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Histoires de rationnels</title>

  <meta name="author" content="Laurent Garcin" />

  

  <link rel="alternate" type="application/rss+xml" title="Maths MPSI Corot - Mathématiques en MPSI au lycée Corot" href="/feed.xml" />

 <!-- everything has to be repeated twice because on 2016-02-01 GitHub pages migrated to jekyll 3; see bug https://github.com/jekyll/jekyll/issues/4439 -->

  
  
    
      <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" />
    
  

  
  
    
      <link rel="stylesheet" href="/css/bootstrap.min.css" />
    
      <link rel="stylesheet" href="/css/main.css" />
    
  

  
  
    
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
    
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
    
  

  
  

  
  

  
  

  <!-- Facebook OpenGraph tags -->
  <meta property="og:title" content="Histoires de rationnels" />
  <meta property="og:type" content="website" />

  
  <meta property="og:url" content="https://lgarcin.github.io//2016-10-05-stern//" />
  

  
  <meta property="og:image" content="https://lgarcin.github.io//img/pi.png" />
  

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
      }
    });
  </script>
  <script type="text/javascript"
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://lgarcin.github.io/">Maths MPSI Corot</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
	    
	      
	      
        <li>
          
          

        

	      <a href="/">Accueil</a>
	      </li>
	    
	      
	      
        <li>
          
          

        

	      <a href="/cours">Cours</a>
	      </li>
	    
	      
	      
        <li>
          
          

        

	      <a href="/td">Exercices</a>
	      </li>
	    
	      
	      
        <li>
          
          

        

	      <a href="/vieclasse">Vie de Classe</a>
	      </li>
	    
	      
	      
        <li>
          
          

        

	      <a href="/devoirs">Devoirs</a>
	      </li>
	    
      </ul>
    </div>

	
	<div class="avatar-container">
	  <div class="avatar-img-border">
	    <a href="https://lgarcin.github.io/ ">
	      <img class="avatar-img" src="/img/pi.png" alt="Pi"/>
		</a>
	  </div>
	</div>
	

  </div>
</nav>


    <div role="main" class="container main-content">
      <header class="header-post">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <div class="post-heading">
        <h1>Histoires de rationnels</h1>
        
        <span class="post-meta">Posted on October 5, 2016</span>
      </div>
     </div>
  </div>
</header>

<article>
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
	  <p>Toutes les fractions sont des fractions d’entiers naturels. Baratin sur fraction $1/0$.</p>

<h3 id="mdiante-de-deux-fractions">Médiante de deux fractions</h3>

<p>On appelle <em>médiante</em> de deux fractions $\frac{a}{b}$ et $\frac{c}{d}$ la fraction $\frac{a}{b}\oplus\frac{c}{d}=\frac{a+c}{b+d}$.</p>

<p>Pour deux fractions $r_1=\frac{a}{b}$ et $r_2=\frac{c}{d}$, on pose $\Delta(r_1,r_2)=bc-ad$</p>

<p>On énonce quelques résultats qui nous suivront par la suite.</p>

<ul>
  <li>
    <p>Si $r_1$ et $r_2$ sont deux fractions, $r_1\lt r_2$ si et seulement si $\Delta(r_1,r_2)\gt0$ et $r_1=r_2$ si et seulement si $\Delta(r_1,r_2)=0$.</p>
  </li>
  <li>
    <p>Si $r_1$ et $r_2$ sont deux fractions, $\Delta(r_1,r_1\oplus r_2)=\Delta(r_1\oplus r_2,r_2)$.</p>
  </li>
  <li>
    <p><a name="ordre"></a> Si $r_1$ et $r_2$ sont deux fractions tels que $r_1\lt r_2$, alors $r_1\lt r_1\oplus r_2\lt r_2$.</p>
  </li>
  <li>
    <p>Si $r$ est une fraction, alors $r\oplus r=r$.</p>
  </li>
  <li>
    <p><a name="encadre"></a>Si $r$ est une fraction non nulle et non infinie, alors il existe un unique couple de fractions $\rho$ et $\sigma$ tels que $\rho\lt r\lt\sigma$ et $\Delta(\rho,\sigma)=1$.</p>
  </li>
</ul>

<p>$\frac{p}{q}$ est une fraction d’entiers non nuls, il existe un unique couple de fractions $\frac{a}{b}$ et $\frac{c}{d}$ tels que $bc-ad=1$ et $\frac{p}{q}=\frac{a}{b}\oplus\frac{c}{d}$. Supposons qu’un tel couple existe. Alors on a vu précédemment que $bp-aq=1$ et $cq-dp=1$.</p>

<h3 id="calcul-de-suites-finies">Calcul de suites finies</h3>

<p>On construit une suite de suites finies de rationnels par récurrence. On pose $u_0=\left(\frac{0}{1},\frac{1}{0}\right)$ et une fois une suite finie $u_n$ construite, on construit la suite $u_{n+1}$ en intercalant entre deux fractions consécutives de la suite $u_n$ la médiante de ces deux fractions<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup>. On trouve donc successivement</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align*}
u_0&=\left(\frac{0}{1},\frac{1}{0}\right)\\
u_1&=\left(\frac{0}{1},\frac{1}{1},\frac{1}{0}\right)\\
u_2&=\left(\frac{0}{1},\frac{1}{2},\frac{1}{1},\frac{2}{1},\frac{1}{0}\right)\\
u_3&=\left(\frac{0}{1},\frac{1}{3},\frac{1}{2},\frac{2}{3},\frac{1}{1},\frac{3}{2},\frac{2}{1},\frac{3}{1},\frac{1}{0}\right)\\
u_4&=\left(\frac{0}{1},\frac{1}{4},\frac{1}{3},\frac{2}{5},\frac{1}{2},\frac{3}{5},\frac{2}{3},\frac{3}{4},\frac{1}{1},\frac{4}{3},\frac{3}{2},\frac{5}{3},\frac{2}{1},\frac{5}{2},\frac{3}{1},\frac{4}{1},\frac{1}{0}\right)
\end{align*} %]]></script>

<p>Le programme suivant permet de calculer les termes successifs de la suite $(u_n)$. Les rationnels sont représentés par des couples d’entiers naturels.</p>

<iframe src="https://trinket.io/embed/python3/3fba0de1ac" width="100%" height="356" frameborder="0" marginwidth="0" marginheight="0" allowfullscreen=""></iframe>

<p>On peut remarquer que chacune des suites $u_n$ est strictement croissante. Cela se prouve par récurrence sur $n$ à l’aide du <a href="#ordre">premier résultat</a> sur la médiante.</p>

<p>Il est aussi remarquable que toutes les fractions apparaissant dans chaque suite $u_n$ sont irréductibles. Le <a href="#irreductible">second résultat</a> sur la médiante permet en effet de prouver par récurrence sur $n$ que si $\frac{a}{b}$ et $\frac{c}{d}$ sont deux fractions consécutives d’une suite $u_n$, alors $ad-bc=1$. Le théorème de Bézout assure alors que toutes les fractions des suites $u_n$ sont irréductibles.</p>

<p>On remarque également que dans une suite $u_n$, une fraction est toujours la médiante des deux fractions l’encadrant. Par exemple, dans la suite $u_4$, $\frac{2}{5}=\frac{1}{3}\oplus\frac{1}{2}$ mais également, $\frac{4}{3}\oplus\frac{5}{3}=\frac{9}{6}=\frac{3}{2}$. On raisonne par récurrence. La propriété à montrer est évidemment vraie pour la suite $u_1$. Supposons qu’elle soit également vraie pour une suite $u_n$ où $n\geq1$. On se donne alors trois fractions successives $r_1$, $r_2$ et $r_3$ de la suite $u_{n+1}$. Si $r_2$ n’apparaissait pas dans la suite $u_n$, alors $r_2=r_1\oplus r_3$ par définition de la suite $u_{n+1}$. Par contre, si $u_2$ apparaissait déjà dans la suite $u_n$, en notant $\rho$ et $\rho’$ les fractions encadrant $r_2$ dans la suite $u_n$, on a $r_2=\rho\oplus\rho’$ par hypothèse de récurrence  ainsi que $r_1=\rho\oplus r_2$ et $r_3=r_2\oplus\rho’$ par définition de $u_{n+1}$. Par commutativité et associativité de $\oplus$, on obtient donc</p>

<script type="math/tex; mode=display">r_1\oplus r_3=\rho\oplus r_2\oplus r_2\oplus\rho'=\rho\oplus r_2\oplus\rho'=r_2\oplus\rho\oplus\rho'=r_2\oplus r_2=r_2</script>

<p>Lorsqu’une fraction $\frac{p}{q}$ (avec $p$ et $q$ non nuls) apparaît pour la première fois dans une suite $u_n$, on peut retrouver les deux fractions qui l’encadrent. En notant $\frac{a}{b}$ et $\frac{c}{d}$ ces deux fractions, on doit avoir $\frac{p}{q}=\frac{a}{b}\oplus\frac{c}{d}$. De plus, on a nécessairement $b\geq1$ et $c\geq1$ donc $a=p-c\leq p-1$ et $d=q-b\leq q-1$. D’après ce qui précède, on a également $bp-aq=1$ et $cq-dp=1$. Pour déterminer la fraction $\frac{a}{b}$, il suffit de déterminer un couple $(u,v)$ d’entiers relatifs tels que $vp-uq=1$ par l’algorithme d’Euclide éténdu. On détermine ensuite l’unique entier $k$ tel que $0\leq u+kp\leq p-1$ puis on pose $a=u+kp$ et $b=v+kq$. On procède de même pour trouver $\frac{c}{d}$. Par exemple, pour trouver les fractions encadrant $\frac{5}{7}$ lorque cette fraction apparaît pour la première fois, on remarque que d’une part, $3\times5-2\times7=1$ et $2\leq5-1$ et que d’autre part $3\times7-4\times5=1$ et $4\leq7-1$. Les fractions recherchées sont donc $\frac{2}{3}$ et $\frac{3}{4}$.</p>

<p>Ce qui est plus surprenant est que tout rationnel positif figure à partir d’un certaing rang dans les suites $u_n$. Supposons que ce ne soit pas le cas et donnons-nous une fraction $\frac{p}{q}$ n’apparaisse dans aucune des suites $u_n$ telle que $p+q$ soit minimal. On peut alors construire des fractions $\frac{a}{b}$ et $\frac{c}{d}$ telle que $\frac{a}{b}\oplus\frac{c}{d}=\frac{p}{q}$ et $bc-ad=1$. On a donc nécessairement $b\geq1$ et $c\geq1$. Comme $(a+b)+(c+d)=p+q$, on en déduit que $a+b\lt p+q$ et $c+d\lt p+q$. Par minimalité de $p+q$, les fractions $\frac{a}{b}$ et $\frac{c}{d}$ figurent chacun dans une des suites $u_n$. Puisque $bc-ad=1$, ces deux fractions sont consécutives dans une même suite $u_n$ (A VOIR). Par conséquent, leur médiante, à savoir $\frac{p}{q}$ figure dans $u_{n+1}$.</p>

<h3 id="construction-de-larbre-de-stern-brocot">Construction de l’arbre de Stern-Brocot</h3>

<p>On peut également représenter les fractions apparaissant dans la suite $(u_n)$ sous forme d’un arbre binaire. On place au niveau 0 les fractions $\frac{0}{1}$ et $\frac{1}{0}$ et au niveau 1 la fraction $\frac{1}{1}$ en tant que fils commun de ces deux fractions. On place au niveau $n+1$ de l’arbre par ordre croissant les fractions apparues dans la suite $u_{n+1}$ alors qu’elles ne figuraient pas dans la suite $u_n$ et on leur donne pour ancêtre la fraction du niveau $n$ dont on s’est servi pour la calculer en tant que médiante. L’arbre ainsi construit est appelé arbre de Stern-Brocot.</p>

<p>Par exemple, la fraction $\frac{3}{5}$ apparaît au niveau 4 et a été calculée comme médiante des fractions $\frac{1}{2}$ et $\frac{2}{3}$. Comme $\frac{2}{3}$ est apparue au niveau 3 tandis que $\frac{1}{2}$ est apparue au niveau 2, on décrète que $\frac{3}{5}$ est le fils de $\frac{2}{3}$.</p>

<p>Voici par exemple l’arbre de Stern-Brocot construit jusqu’au niveau 6.</p>

<p><img src="/images/2016/10/stern.png" alt="Arbre de Stern-Brocot" /></p>

<p>Puisque chaque rationel de $\mathbb Q_+$ apparaît une et une seule fois dans l’arbre, on peut construire une suite prenant une et une seule fois chaque valeur dans $\mathbb Q_+$ : il suffit pour cela de numéroter les noeuds de l’arbre de Stern-Brocot (en laissant de côté la fraction $\frac{1}{0}$), par exemple de haut en bas puis de gauche à droite. Cette suite réalise donc une bijection de $\mathbb N$ sur $\mathbb Q_+$. Autrement dit, $\mathbb Q_+$ est dénombrable.</p>

<p>Il est alors facile de déterminer les fils gauche et droit d’un noeud de l’arbre connaissant ses ancêtres. Pour déterminer le fils gauche, on calcule la médiante du noeud considéré et de son premier ancêtre qui lui est inférieur tandis que pour déterminer le fils droit, on calcule la médiante du noeud considéré et du premier ancêtre qui lui est supérieur. Par exemple, le premier ancêtre de $\frac{5}{8}$ qui lui est inférieur est $\frac{3}{5}$ et son premier ancêtre qui lui est supérieur est $\frac{2}{3}$ donc les fils gauche et droit de $\frac{5}{8}$ sont respectivement $\frac{5}{8}\oplus\frac{3}{5}=\frac{8}{13}$ et $\frac{5}{8}\oplus\frac{2}{3}=\frac{7}{11}$. De même, les fils gauche et droit de $\frac{5}{4}$ sont $\frac{5}{4}\oplus\frac{1}{1}=\frac{6}{5}$ et $\frac{5}{4}\oplus\frac{4}{3}=\frac{9}{7}$.</p>

<iframe src="https://trinket.io/embed/python3/2a3fff74c7" width="100%" height="356" frameborder="0" marginwidth="0" marginheight="0" allowfullscreen=""></iframe>

<p>fonction fusc</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>Petit exercice facile : calculer le nombre de termes de $u_n$ en fonction de $n$. <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

	</div>
  </div>
</article>

<div class="row">
  <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
    <ul class="pager blog-pager">
      
      <li class="previous">
        <a href="/2016-09-26-gravitation/" data-toggle="tooltip" data-placement="top" title="Méthode d'Euler et gravitation">&larr; Previous Post</a>
      </li>
      
      
    </ul>
  </div>
</div>


<div class="row disqus-comments">
  <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
    
<div class="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">
	    var disqus_shortname = 'mpsi';
	    // ensure that pages with query string get the same discussion
            var url_parts = window.location.href.split("?");
            var disqus_url = url_parts[0];	    
	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();
	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>


  </div>
</div>


    </div>

    <footer>
  <div class="container beautiful-jekyll-footer">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
          <li>
            <a href="https://github.com/lgarcin" title="GitHub">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		  
		  
          <li>
            <a href="mailto:laurent.garcin@gmail.com" title="Email me">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		  
          <li>
            <a href="https://linkedin.com/in/laurent-garcin-b2b02ab7" title="LinkedIn">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		  
          <li>
            <a href="https://stackoverflow.com/users/4439374/laurent-garcin" title="StackOverflow">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		  
		  <li>
			<a href="/feed.xml" title="RSS">
			  <span class="fa-stack fa-lg">
				<i class="fa fa-circle fa-stack-2x"></i>
				<i class="fa fa-rss fa-stack-1x fa-inverse"></i>
			  </span>
			</a>
		  </li>
          
        </ul>
        <p class="copyright text-muted">
		  Laurent Garcin
		  &nbsp;&bull;&nbsp;
		  2016

		  
		  &nbsp;&bull;&nbsp;
		  <a href="https://lgarcin.github.io/">lgarcin.github.io</a>
		  
	    </p>
	        <!-- Please don't remove this, keep my open source work credited :) -->
		<p class="theme-by text-muted">
		  Theme by
		  <a href="http://deanattali.com/beautiful-jekyll/">beautiful-jekyll</a>
		</p>
      </div>
    </div>
  </div>
</footer>


    <!-- everything has to be repeated twice because on 2016-02-01 GitHub pages migrated to jekyll 3; see bug https://github.com/jekyll/jekyll/issues/4439 -->











  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script>
      	if (typeof jQuery == 'undefined') {
      	  document.write('<script src="/js/jquery-2.1.min.js"></scr' + 'ipt>');
      	}
      </script>
    
  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
	<script src="/js/bootstrap.min.js"></script>
    
  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
	<script src="/js/main.js"></script>
    
  




	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-30206958-3', 'auto');
		ga('send', 'pageview');
	</script>
	<!-- End Google Analytics -->


  </body>
</html>
